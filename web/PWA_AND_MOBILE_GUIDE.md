# PWA & Mobile Guide

## Overview

This guide covers the Progressive Web App (PWA) implementation and mobile optimization for the Health Journal application. The app is designed to provide a native-like experience across all devices.

## PWA Features

### âœ… Implemented Features

- **Offline Support** - App works without internet connection
- **Install Prompt** - Users can install to home screen/desktop
- **App-like Experience** - Fullscreen mode, no browser UI
- **Fast Loading** - Assets cached with service worker
- **Responsive Design** - Optimized for all screen sizes
- **Touch-friendly UI** - 44px minimum touch targets

### ðŸ”§ Configuration

#### Manifest Configuration
```json
{
  "name": "Health Journal",
  "short_name": "Salubro",
  "description": "Track your health journey with medical-grade assessment tools",
  "theme_color": "#3b82f6",
  "background_color": "#ffffff",
  "display": "standalone",
  "orientation": "portrait"
}
```

#### Service Worker Caching
- **Static Assets**: HTML, CSS, JS, images cached indefinitely
- **API Calls**: NetworkFirst strategy with 5-minute cache
- **Fonts**: CacheFirst strategy with 1-year expiration

## Mobile Navigation

### Bottom Navigation Bar
Located in `src/components/MobileNav.tsx`

**Features:**
- Fixed bottom position on mobile devices
- Hidden on desktop (md:hidden)
- Safe area inset support
- Active state indicators
- Primary action button (elevated)

**Navigation Items:**
- Dashboard (/)
- Records (/records)
- New Record (/records/new) - Primary action
- Profile (/profile)

### Mobile-First Design Principles

1. **Touch Targets**: Minimum 44x44px for all interactive elements
2. **Thumb-friendly**: Important actions within thumb reach
3. **Visual Hierarchy**: Clear contrast and spacing
4. **Performance**: Optimized for slower mobile connections

## Installation Guide

### Prerequisites
```bash
npm install vite-plugin-pwa workbox-window -D
```

### Required Files

#### 1. App Icons
Create in `public/icons/`:
- icon-72x72.png
- icon-96x96.png  
- icon-128x128.png
- icon-144x144.png
- icon-152x152.png
- icon-192x192.png
- icon-384x384.png
- icon-512x512.png

#### 2. Service Worker Registration
Auto-generated by Vite PWA plugin

#### 3. Install Component
`InstallPWA.tsx` handles installation prompts

## Mobile Optimization

### CSS Classes for Mobile
```css
/* Mobile-only visibility */
.md:hidden

/* Safe area support */
.safe-area-inset-bottom

/* Touch-friendly sizing */
.min-w-[60px] .py-2 .px-3

/* Mobile-first responsive */
.flex-col .items-center
```

### Performance Optimizations

1. **Code Splitting**: React vendor and UI vendor chunks
2. **Image Optimization**: WebP format with fallbacks
3. **Lazy Loading**: Route-based code splitting
4. **Caching Strategy**: Aggressive caching for static assets

### Accessibility Features

- **Screen Reader Support**: Proper ARIA labels
- **Keyboard Navigation**: Tab order and focus management
- **High Contrast**: WCAG AA compliant colors
- **Touch Accessibility**: Large touch targets

## Testing PWA Features

### Chrome DevTools
1. Open DevTools (F12)
2. Go to Application tab
3. Check Manifest section
4. Verify Service Worker registration
5. Test offline functionality
6. Validate installability

### Mobile Testing
1. **iOS Safari**: Add to Home Screen
2. **Android Chrome**: Install app prompt
3. **Desktop**: Install from address bar

### Lighthouse Audit
Run PWA audit to verify:
- Performance score > 90
- Accessibility score > 90
- Best Practices score > 90
- PWA score = 100

## Deployment Considerations

### Production Build
```bash
npm run build
```

### Environment Variables
```env
VITE_API_URL=https://your-api.com
VITE_PWA_ENABLED=true
```

### HTTPS Requirement
PWA features require HTTPS in production

### Cache Invalidation
Service worker updates automatically on new deployments

## Troubleshooting

### Common Issues

1. **Install prompt not showing**
   - Check HTTPS requirement
   - Verify manifest.json validity
   - Clear browser cache

2. **Service worker not updating**
   - Hard refresh (Ctrl+Shift+R)
   - Clear application data
   - Check network tab for SW updates

3. **Icons not displaying**
   - Verify icon paths in manifest
   - Check file sizes and formats
   - Validate icon dimensions

### Debug Commands
```bash
# Check PWA status
npm run build && npm run preview

# Validate manifest
npx pwa-asset-generator --help

# Test service worker
chrome://inspect/#service-workers
```

## Future Enhancements

### Planned Features
- **Push Notifications**: Health reminders
- **Background Sync**: Offline data sync
- **Biometric Auth**: Fingerprint/Face ID
- **Share API**: Share health records
- **File System Access**: Export/import data

### Performance Improvements
- **Image Compression**: Automatic WebP conversion
- **Bundle Analysis**: Identify optimization opportunities
- **Critical CSS**: Inline critical styles
- **Preloading**: Strategic resource preloading

## Best Practices

### Mobile UX
1. Keep navigation simple and consistent
2. Use familiar mobile patterns
3. Provide clear feedback for actions
4. Minimize form inputs on mobile
5. Use progressive disclosure

### PWA Standards
1. Fast loading (< 3 seconds)
2. Reliable offline experience
3. Engaging user interface
4. Secure (HTTPS only)
5. Discoverable and installable

### Development Workflow
1. Test on real devices regularly
2. Use mobile-first CSS approach
3. Optimize images and assets
4. Monitor Core Web Vitals
5. Regular PWA audits

## Resources

- [PWA Checklist](https://web.dev/pwa-checklist/)
- [Mobile Web Best Practices](https://developers.google.com/web/fundamentals/design-and-ux/principles)
- [Workbox Documentation](https://developers.google.com/web/tools/workbox)
- [Vite PWA Plugin](https://vite-pwa-org.netlify.app/)